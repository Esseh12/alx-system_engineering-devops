#!/bin/bash

# Check if the script is run as root
if [ "$(id -u)" != "0" ]; then
   echo "This script must be run as root" 1>&2
   exit 1
fi

# Define the paths to the hosts file
HOSTS_FILE="/etc/hosts"
HOSTS_FILE_BACKUP="/etc/hosts.backup"

# Check if a backup already exists, if not, create one
if [ ! -f "$HOSTS_FILE_BACKUP" ]; then
    echo "Creating backup of the current hosts file..."
    cp "$HOSTS_FILE" "$HOSTS_FILE_BACKUP"
    echo "Backup created at $HOSTS_FILE_BACKUP"
fi

# Update the hosts file
echo "Updating the hosts file..."

# Add localhost to resolve to 127.0.0.2
echo "127.0.0.2 localhost" >> "$HOSTS_FILE"

# Add facebook.com to resolve to 8.8.8.8
echo "8.8.8.8 facebook.com" >> "$HOSTS_FILE"

# Inform the user that the changes are complete
echo "The hosts file has been updated successfully."
echo "localhost now resolves to 127.0.0.2"
echo "facebook.com now resolves to 8.8.8.8"

# Restart the networking service to apply changes
echo "Restarting the networking service to apply changes..."
systemctl restart networking

echo "Done."

